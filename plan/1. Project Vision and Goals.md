# ICU4C Universal Static Bundle: Vision, Goals, and Success Criteria

## Vision

ICU4C is a powerful but complex and heavyweight library. Integrating it into custom C, C++, or other C++-compatible applications—especially in cross-platform contexts—can be difficult due to runtime dependencies, platform inconsistencies, and build system challenges.

Wouldn't it be nice if developers had a single, portable, static ICU bundle they could drop into their projects—without worrying about ICU being installed on the target system, or dealing with platform-specific quirks?

The vision of the ICU4C Universal Static Bundle is to make that possible. By producing a self-contained, cross-platform ICU static library that embeds all necessary ICU data, we aim to make ICU integration dramatically simpler and more reliable—particularly for developers building custom static libraries or applications.

To do this, we use the Zig C++ compiler, which supports cross-compilation to Linux, macOS, and Windows (including x64 and arm64) from a single Linux host. This means we can maintain a Linux-centric toolchain and development environment, while still producing binaries for all major platforms. Zig ensures consistent ABI behavior, simplifies the build process, and eliminates the need for separate toolchains or host environments for each target platform.

To help illustrate the end-to-end workflow:

```
+--------------------+
|  ICU4C Source Code |
+--------------------+
          |
          |  (build with Zig C++ compiler)
          v
+*******************************************+
* ICU4C Universal Static Bundle             *
*  (libicuuc.a, libicui18n.a, libicudata.a) *
+*******************************************+
          |
          |  (link against other custom libs)
          v
+-----------------------------+
| Other Custom Libraries      |
|  (your code, excluding ICU) |
+-----------------------------+
          |
          |  (final link step)
          v
+----------------------------------+
| Application Executable           |
|  (uses ICU static lib and        |
|   your custom libraries only)    |
+----------------------------------+
```

**Explanation:** The ICU4C Universal Static Bundle—highlighted in the diagram above—is the central deliverable of this project. It combines all necessary ICU4C components (including libicuuc.a, libicui18n.a, and libicudata.a) into a single, portable static bundle. It is compiled with Zig and embeds ICU data directly, allowing it to be linked into applications across Linux, macOS, and Windows (both x64 and arm64) without requiring an ICU runtime on the host system. This leads to consistent, reproducible, and ABI-safe application builds.


## Goals

To achieve that vision, the project aims to build a distribution that:

- **Produces static ICU libraries for six major target platforms:**
  - linux-x64, linux-arm64
  - macos-x64, macos-arm64
  - windows-x64, windows-arm64

- **Embeds ICU data** into each static library (`libicuuc.a`, `libicui18n.a`, `libicudata.a`) to eliminate external ICU dependencies at runtime. (Later we may split the data when we find a good way to do it).

- **Uses the Zig C++ compiler** as the build toolchain to simplify cross-compilation and ensure consistent ABI behavior across platforms.
  A specific Zig version will be selected for each release and recorded in the reproducibility metadata.

- **Bundles headers and documentation:**
  - `include/unicode/` for ICU public headers
  - `README.md`, `VERSION.txt`, and `metadata.json` for usage information and build reproducibility

- **Provides a Unix-centric Docker-based build environment:**
  - Based on Ubuntu 24.04 LTS
  - Includes Zig, CMake, build-essential, and all required tools pre-installed
  - Ensures consistent builds across contributors and CI pipelines

- **Delivers a portable .tar.gz archive:**
  - Named like `icu4c-universal-static-bundle-v74.2.tar.gz`
  - Contains all headers, libraries, and metadata needed to build and link a sample program
  - Designed for use on Unix-like systems, regardless of the target platform

- **Provides a GitHub Actions-compatible CI pipeline and Docker-based build system:**
  - Builds ICU for all supported targets using the same Docker image used in development
  - Scripts related to be build will be used in the Docker and the GitHub Actions pipeline
  - Verifies correctness and consistency of the output artifacts
  - Runs sample builds to confirm end-to-end usability across platforms
  - The source and target file most be read/writable by the user running the build (without sudo).

- **Includes sample usage:**
  - A minimal application and a static library linking against the ICU bundle
  - Used both for CI verification and as reference examples

- **Provides a Unix-centric Docker-based build environment:**
  - Based on Ubuntu latest LTS (currently 24.04)
  - Includes Zig, CMake, build-essential, and other required build tools pre-installed
  - Integrates Jupyter Notebook with a Bash kernel to enable interactive scripting, inspection, and testing inside the container
  - Ensures consistent builds across contributors and CI pipelines using the same base environment

- **Provides helper tools** to simplify using the bundle for downstream static libraries or applications

## Success Criteria

We'll know the build is successful when:

- ✅ The `dist/` directory includes static ICU libraries and headers for each target, with architectures verified using tools like `file`.

- ✅ Applications built with the selected Zig C++ compiler version link successfully against the libraries and run correctly across all supported platforms, with no external ICU runtime dependency.

- ✅ The .tar.gz archive includes `README.md`, `VERSION.txt`, and `metadata.json`, all accurately documenting the compiler version, build environment, target platforms, and configuration details.

- ✅ The Docker build environment allows any contributor or CI system to reproduce the build and generate identical artifacts.

- ✅ The GitHub Actions workflow builds the static libraries for all platforms, runs sample builds, and passes verification checks.

- ✅ The sample application and sample static library build and run correctly using only the contents of the .tar.gz archive—no external ICU installation required.